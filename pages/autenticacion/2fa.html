<section id="2fa" class="page">
    <h2>Autenticaci√≥n de dos factores (2FA/MFA)</h2>
    <p class="page-description">La autenticaci√≥n de dos factores agrega una capa extra de seguridad requiriendo
        dos formas diferentes de verificar tu identidad, haciendo extremadamente dif√≠cil el acceso no autorizado.</p>

    <div class="demo-container">
        <div class="demo-section">
            <h3>Los tres factores de autenticaci√≥n</h3>
            <div class="algo-info">
                <div class="factor-card">
                    <div class="factor-icon">üß†</div>
                    <div class="factor-content">
                        <strong>1. Algo que SABES</strong>
                        <ul>
                            <li>Contrase√±a</li>
                            <li>PIN</li>
                            <li>Pregunta de seguridad</li>
                        </ul>
                    </div>
                </div>

                <div class="factor-card">
                    <div class="factor-icon">üì±</div>
                    <div class="factor-content">
                        <strong>2. Algo que TIENES</strong>
                        <ul>
                            <li>Tel√©fono m√≥vil (SMS/App)</li>
                            <li>Token de hardware (YubiKey)</li>
                            <li>Tarjeta inteligente</li>
                        </ul>
                    </div>
                </div>

                <div class="factor-card">
                    <div class="factor-icon">üë§</div>
                    <div class="factor-content">
                        <strong>3. Algo que ERES</strong>
                        <ul>
                            <li>Huella dactilar</li>
                            <li>Reconocimiento facial</li>
                            <li>Iris/retina</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div class="demo-section">
            <h3>üì≤ Tipos de 2FA</h3>
            <div class="mfa-types">
                <div class="mfa-type">
                    <h4>üí¨ SMS (Menos seguro)</h4>
                    <p>C√≥digo enviado por mensaje de texto</p>
                    <div class="pro-con">
                        <div class="pro">‚úÖ F√°cil de usar</div>
                        <div class="con">‚ùå Vulnerable a SIM swapping</div>
                        <div class="con">‚ùå Requiere cobertura celular</div>
                    </div>
                </div>

                <div class="mfa-type">
                    <h4>üì± App Authenticator (Recomendado)</h4>
                    <p>TOTP - C√≥digo temporal generado por app</p>
                    <div class="pro-con">
                        <div class="pro">‚úÖ Funciona sin internet</div>
                        <div class="pro">‚úÖ M√°s seguro que SMS</div>
                        <div class="con">‚ùå Puede perderse con el tel√©fono</div>
                    </div>
                </div>

                <div class="mfa-type">
                    <h4>üîë Hardware Token (M√°s seguro)</h4>
                    <p>Dispositivo f√≠sico (YubiKey, Titan)</p>
                    <div class="pro-con">
                        <div class="pro">‚úÖ Resistente a phishing</div>
                        <div class="pro">‚úÖ Muy seguro</div>
                        <div class="con">‚ùå Costo adicional</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="demo-section" style="margin-top: 24px;">
        <h3>Demo: Generador TOTP (Time-based OTP)</h3>
        <div class="totp-demo">
            <p><strong>C√≥mo funciona TOTP:</strong> Algoritmo HMAC-SHA1 + timestamp actual = c√≥digo de 6 d√≠gitos</p>

            <div class="totp-display">
                <div class="totp-code" id="totp-code">------</div>
                <div class="totp-timer">
                    <div class="timer-bar" id="timer-bar"></div>
                    <div class="timer-text" id="timer-text">30s</div>
                </div>
            </div>

            <button id="totp-start" class="btn-primary">Iniciar Generador TOTP</button>

            <div class="code-example" style="margin-top: 16px;">
                <strong>Algoritmo TOTP:</strong>
                <pre>
1. Secret Key compartida: K (almacenada en app y servidor)
2. Timestamp actual: T (en intervalos de 30 segundos)
3. HMAC-SHA1(K, T) = Hash
4. Extraer 6 d√≠gitos del hash
5. C√≥digo v√°lido solo por 30 segundos
                </pre>
            </div>
        </div>
    </div>

    <div class="comparison-table">
        <h3>‚öñÔ∏è Comparaci√≥n de m√©todos 2FA</h3>
        <table>
            <thead>
                <tr>
                    <th>M√©todo</th>
                    <th>Seguridad</th>
                    <th>Usabilidad</th>
                    <th>Costo</th>
                    <th>Resistencia Phishing</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>SMS</strong></td>
                    <td>üü° Media</td>
                    <td>üü¢ Alta</td>
                    <td>üü¢ Gratis</td>
                    <td>‚ùå Baja</td>
                </tr>
                <tr>
                    <td><strong>App TOTP</strong></td>
                    <td>üü¢ Alta</td>
                    <td>üü¢ Alta</td>
                    <td>üü¢ Gratis</td>
                    <td>‚ö†Ô∏è Media</td>
                </tr>
                <tr>
                    <td><strong>Push Notification</strong></td>
                    <td>üü¢ Alta</td>
                    <td>üü¢ Muy alta</td>
                    <td>üü¢ Gratis</td>
                    <td>‚ö†Ô∏è Media</td>
                </tr>
                <tr>
                    <td><strong>Hardware Token</strong></td>
                    <td>üü¢ Muy alta</td>
                    <td>üü° Media</td>
                    <td>üî¥ $20-50</td>
                    <td>‚úÖ Muy alta</td>
                </tr>
                <tr>
                    <td><strong>Biom√©trico</strong></td>
                    <td>üü¢ Alta</td>
                    <td>üü¢ Muy alta</td>
                    <td>üü° Variable</td>
                    <td>‚úÖ Alta</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="info-box" style="background: #ffebee; border-left-color: #f44336;">
        <h4>‚ö†Ô∏è Ataques contra 2FA</h4>
        <ul>
            <li><strong>SIM Swapping:</strong> Atacante convence a operador de transferir n√∫mero a nueva SIM</li>
            <li><strong>Phishing de c√≥digo:</strong> P√°gina falsa solicita c√≥digo 2FA adem√°s de password</li>
            <li><strong>Man-in-the-Middle:</strong> Interceptar y reenviar c√≥digo en tiempo real</li>
            <li><strong>Session Hijacking:</strong> Robar cookie despu√©s de autenticaci√≥n exitosa</li>
            <li><strong>SS7 Attack:</strong> Explotar vulnerabilidad en protocolo de telefon√≠a</li>
        </ul>
    </div>

    <div class="info-box" style="background: #e8f5e9; border-left-color: #4caf50;">
        <h4>‚úÖ Mejores Pr√°cticas</h4>
        <ul>
            <li>Usar <strong>app authenticator</strong> o <strong>hardware token</strong> en vez de SMS</li>
            <li>Guardar <strong>c√≥digos de respaldo</strong> en lugar seguro</li>
            <li>Registrar <strong>m√∫ltiples dispositivos</strong> 2FA como backup</li>
            <li>Habilitar 2FA en <strong>todas las cuentas importantes</strong> (email, banco, redes sociales)</li>
            <li>Nunca compartir c√≥digos 2FA con nadie (ni "soporte t√©cnico")</li>
            <li>Considerar <strong>YubiKey</strong> para cuentas cr√≠ticas</li>
            <li>Revisar peri√≥dicamente <strong>sesiones activas</strong></li>
        </ul>
    </div>

    <div class="info-box">
        <h4>Apps Authenticator Recomendadas</h4>
        <ul>
            <li><strong>Google Authenticator:</strong> Simple, ampliamente soportado</li>
            <li><strong>Authy:</strong> Sincronizaci√≥n entre dispositivos, backup en nube</li>
            <li><strong>Microsoft Authenticator:</strong> Integraci√≥n con servicios Microsoft</li>
            <li><strong>1Password:</strong> Gestor de contrase√±as + TOTP integrado</li>
            <li><strong>Aegis (Android):</strong> Open source, cifrado local</li>
        </ul>
    </div>
</section>

<style>
    .factor-card {
        display: flex;
        gap: 16px;
        background: white;
        padding: 16px;
        border-radius: 8px;
        margin-bottom: 12px;
        border-left: 4px solid #1687a7;
    }

    .factor-icon {
        font-size: 3em;
        flex-shrink: 0;
    }

    .factor-content strong {
        color: #1687a7;
        display: block;
        margin-bottom: 8px;
    }

    .mfa-types {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 16px;
    }

    .mfa-type {
        background: white;
        padding: 16px;
        border-radius: 8px;
        border: 2px solid #e0e0e0;
    }

    .mfa-type h4 {
        margin-top: 0;
        color: #1687a7;
    }

    .pro-con {
        margin-top: 12px;
        font-size: 0.9em;
    }

    .pro {
        color: #4caf50;
        margin: 4px 0;
    }

    .con {
        color: #f44336;
        margin: 4px 0;
    }

    .totp-demo {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 8px;
    }

    .totp-display {
        background: white;
        padding: 32px;
        border-radius: 12px;
        text-align: center;
        margin-bottom: 20px;
        border: 3px solid #1687a7;
    }

    .totp-code {
        font-size: 3em;
        font-family: 'Courier New', monospace;
        font-weight: bold;
        color: #1687a7;
        letter-spacing: 8px;
    }

    .totp-timer {
        margin-top: 20px;
    }

    .timer-bar {
        height: 8px;
        background: linear-gradient(90deg, #4caf50, #ff9800);
        border-radius: 4px;
        transition: width 1s linear;
    }

    .timer-text {
        margin-top: 8px;
        font-weight: bold;
        color: #666;
    }

    @keyframes pulse {

        0%,
        100% {
            transform: scale(1);
        }

        50% {
            transform: scale(1.1);
        }
    }
</style>