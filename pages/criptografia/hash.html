<section id="hash" class="page">
    <h2>Funciones hash criptogr√°ficas</h2>
    <p class="page-description">Las funciones hash son algoritmos que transforman datos de cualquier tama√±o
        en un valor de tama√±o fijo (hash). Son fundamentales para verificar integridad, almacenar contrase√±as y
        blockchain [1-3,11].</p>

    <div class="demo-section">
        <h3>Propiedades de una funci√≥n hash [1-3,11]</h3>
        <div class="algo-info">
            <ul>
                <li><strong>Determinista:</strong> Misma entrada ‚Üí Siempre mismo hash</li>
                <li><strong>R√°pida:</strong> C√°lculo eficiente del hash</li>
                <li><strong>Efecto avalancha:</strong> Peque√±o cambio ‚Üí Hash completamente diferente</li>
                <li><strong>Unidireccional:</strong> Imposible obtener entrada desde hash</li>
                <li><strong>Resistencia a colisiones:</strong> Dif√≠cil encontrar dos entradas con mismo hash</li>
            </ul>
        </div>
    </div>

    <div class="demo-section">
        <h3>üß™ Demostraci√≥n interactiva</h3>
        <div class="input-group">
            <label for="hash-input">Texto a hashear:</label>
            <input type="text" id="hash-input" placeholder="Escribe algo..." value="Hola Mundo" />
        </div>

        <button id="hash-calculate" class="btn-primary">Calcular Hashes</button>

        <div id="hash-results" class="result-box">
            <p>Los hashes aparecer√°n aqu√≠...</p>
        </div>

        <div class="info-box" style="margin-top: 16px; background: #fff3e0;">
            <strong>üí° Prueba esto:</strong> Cambia una sola letra y observa c√≥mo el hash cambia completamente
            (efecto avalancha)
        </div>

        <div class="info-box" style="margin-top: 16px; background: #e3f2fd; border-left-color: #2196f3;">
            <h4>üìö Implementaci√≥n t√©cnica</h4>
            <p>Los hashes se calculan utilizando la <strong>Web Crypto API</strong> nativa del navegador:</p>
            <div class="code-example">
                <pre>
// API nativa de JavaScript (no requiere librer√≠as externas)
const encoder = new TextEncoder();
const data = encoder.encode(texto);
const hashBuffer = await crypto.subtle.digest('SHA-256', data);

// Para MD5 y SHA-1: Librer√≠a crypto-js
// &lt;script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"&gt;&lt;/script&gt;
const md5Hash = CryptoJS.MD5(texto).toString();
const sha1Hash = CryptoJS.SHA1(texto).toString();
                </pre>
            </div>
            <p><strong>Librer√≠as utilizadas:</strong></p>
            <ul>
                <li><strong>Web Crypto API:</strong> SHA-256, SHA-384, SHA-512 (nativo del navegador)</li>
                <li><strong>CryptoJS:</strong> MD5, SHA-1, SHA-3 y otros algoritmos legacy</li>
            </ul>
        </div>
    </div>

    <div class="comparison-table">
        <h3>Algoritmos hash populares [11]</h3>
        <table>
            <thead>
                <tr>
                    <th>Algoritmo</th>
                    <th>Tama√±o</th>
                    <th>Velocidad</th>
                    <th>Seguridad</th>
                    <th>Uso</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>MD5</strong></td>
                    <td>128 bits</td>
                    <td>‚ö° Muy r√°pido</td>
                    <td>üî¥ Roto (colisiones)</td>
                    <td>‚ùå No usar</td>
                </tr>
                <tr>
                    <td><strong>SHA-1</strong></td>
                    <td>160 bits</td>
                    <td>‚ö° R√°pido</td>
                    <td>üü° D√©bil</td>
                    <td>‚ö†Ô∏è Deprecado</td>
                </tr>
                <tr>
                    <td><strong>SHA-256</strong></td>
                    <td>256 bits</td>
                    <td>‚ö° R√°pido</td>
                    <td>üü¢ Seguro</td>
                    <td>‚úÖ Bitcoin, SSL</td>
                </tr>
                <tr>
                    <td><strong>SHA-512</strong></td>
                    <td>512 bits</td>
                    <td>‚ö° R√°pido</td>
                    <td>üü¢ Muy seguro</td>
                    <td>‚úÖ Alta seguridad</td>
                </tr>
                <tr>
                    <td><strong>SHA-3</strong></td>
                    <td>Variable</td>
                    <td>üêå Moderado</td>
                    <td>üü¢ Muy seguro</td>
                    <td>‚úÖ Est√°ndar nuevo</td>
                </tr>
                <tr>
                    <td><strong>bcrypt</strong></td>
                    <td>184 bits</td>
                    <td>üêå Lento</td>
                    <td>üü¢ Muy seguro</td>
                    <td>‚úÖ Contrase√±as</td>
                </tr>
                <tr>
                    <td><strong>Argon2</strong></td>
                    <td>Variable</td>
                    <td>üêå Lento</td>
                    <td>üü¢ Excelente</td>
                    <td>‚úÖ Contrase√±as (mejor)</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="demo-section attack-section">
        <h3>‚ö†Ô∏è Colisiones - El Problema de MD5 [1-3,11]</h3>
        <div class="algo-info">
            <p>Una <strong>colisi√≥n</strong> ocurre cuando dos entradas diferentes producen el mismo hash.</p>
            <div class="code-example">
                <strong>Ejemplo real de colisi√≥n MD5:</strong>
                <pre>
Archivo A: [datos binarios 1]
MD5: d131dd02c5e6eec4...

Archivo B: [datos binarios diferentes]
MD5: d131dd02c5e6eec4... ‚Üê ¬°MISMO HASH!

Consecuencia: Un atacante puede sustituir archivos sin ser detectado
                </pre>
            </div>
            <p><strong>Estado actual:</strong></p>
            <ul>
                <li>MD5: ‚ùå Completamente roto (2004)</li>
                <li>SHA-1: ‚ö†Ô∏è Colisiones encontradas (2017)</li>
                <li>SHA-256: ‚úÖ Sin colisiones conocidas</li>
                <li>SHA-3: ‚úÖ Dise√±o resistente a colisiones</li>
            </ul>
        </div>
    </div>

    <div class="demo-section">
        <h3>üç™ Salting - Protecci√≥n de Contrase√±as [1-3,11]</h3>
        <div class="algo-info">
            <p><strong>Salt:</strong> Dato aleatorio √∫nico agregado a cada contrase√±a antes de hashear</p>
            <div class="code-example">
                <strong>Sin Salt (INSEGURO):</strong>
                <pre>
Usuario1: password ‚Üí 5f4dcc3b...
Usuario2: password ‚Üí 5f4dcc3b... ‚Üê ¬°Mismo hash!

Atacante usa rainbow table ‚Üí Rompe ambas passwords
                </pre>
            </div>

            <div class="code-example">
                <strong>Con Salt (SEGURO):</strong>
                <pre>
Usuario1: password + salt1 ‚Üí a9f2bc3d...
Usuario2: password + salt2 ‚Üí 7e8d4a1c... ‚Üê Hash diferente

Cada usuario necesita rainbow table diferente ‚Üí Inviable
                </pre>
            </div>

            <div class="demo-interactive">
                <h4>Demostraci√≥n de Salt:</h4>
                <input type="password" id="salt-password" placeholder="Contrase√±a" value="password123" />
                <button id="salt-demo" class="btn-primary">Generar Hashes con Salt</button>
                <div id="salt-result" class="result-box"></div>
            </div>
        </div>
    </div>

    <div class="info-box">
        <h4>Casos de Uso [1-3,11]</h4>
        <ul>
            <li><strong>Verificaci√≥n de Integridad:</strong> Descargas, actualizaciones de software</li>
            <li><strong>Almacenamiento de Contrase√±as:</strong> Nunca guardar en texto plano</li>
            <li><strong>Firmas Digitales:</strong> Hash del documento + cifrado con clave privada</li>
            <li><strong>Blockchain:</strong> Cada bloque contiene hash del bloque anterior</li>
            <li><strong>Deduplicaci√≥n:</strong> Identificar archivos duplicados sin compararlos byte a byte</li>
            <li><strong>Checksums:</strong> Detectar corrupci√≥n de datos</li>
            <li><strong>Git:</strong> Identificadores √∫nicos de commits (SHA-1)</li>
        </ul>
    </div>

    <div class="info-box" style="background: #e8f5e9; border-left-color: #4caf50;">
        <h4>‚úÖ Mejores pr√°cticas [1-3,11]</h4>
        <ul>
            <li>Para contrase√±as: Usa <strong>Argon2</strong> o <strong>bcrypt</strong> (no SHA-256 directamente)</li>
            <li>Para integridad: Usa <strong>SHA-256</strong> o superior</li>
            <li>Siempre agrega <strong>salt √∫nico</strong> por usuario</li>
            <li>Considera agregar <strong>pepper</strong> (secret key) adicional</li>
            <li>Usa factores de trabajo altos para ralentizar ataques de fuerza bruta</li>
            <li>Migra de MD5/SHA-1 a SHA-256/SHA-3 inmediatamente</li>
        </ul>
    </div>
</section>

<style>
    .demo-interactive {
        background: white;
        padding: 16px;
        border-radius: 6px;
        margin-top: 12px;
    }

    .demo-interactive h4 {
        margin-top: 0;
        color: #1687a7;
    }

    .demo-interactive input {
        width: 100%;
        max-width: 300px;
        margin-bottom: 12px;
    }
</style>