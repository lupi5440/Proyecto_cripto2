<section id="cipher" class="page">
    <h2>Cifrado b√°sico: C√©sar vs AES</h2>
    <p class="page-description">Compara el cifrado cl√°sico de C√©sar con el moderno AES-GCM. Observa c√≥mo ha evolucionado
        la criptograf√≠a desde los tiempos de la Roma antigua hasta los est√°ndares actuales.</p>

    <div class="demo-section" style="max-width: 800px; margin: 20px auto;">
        <h3>Herramienta de cifrado</h3>

        <div class="input-group">
            <label for="cipher-text">Texto a cifrar/descifrar:</label>
            <input id="cipher-text" type="text" placeholder="Escribe tu mensaje aqu√≠..." style="max-width: none;" />
        </div>

        <div class="input-group">
            <label for="cipher-method">M√©todo de cifrado:</label>
            <select id="cipher-method" style="max-width: none;">
                <option value="caesar">Cifrado C√©sar (desplazamiento num√©rico)</option>
                <option value="aes">AES-GCM (cifrado real, contrase√±a m√≠n. 8 caracteres)</option>
            </select>
        </div>

        <div class="input-group">
            <label for="cipher-key">Clave/Desplazamiento:</label>
            <input id="cipher-key" type="text" value="3"
                placeholder="N√∫mero (1-25) para C√©sar, contrase√±a fuerte para AES" style="max-width: none;" />
            <small style="display: block; margin-top: 5px; color: #666;">
                <strong>C√©sar:</strong> Solo n√∫mero (ej: 3, 13, 25) |
                <strong>AES:</strong> M√≠nimo 8 caracteres (ej: MiClave123!)
            </small>
        </div>

        <div style="display: flex; gap: 10px; margin-top: 16px;">
            <button id="cipher-encrypt" class="btn-primary" style="flex: 1; margin: 0;">üîí Cifrar</button>
            <button id="cipher-decrypt" class="btn-primary" style="flex: 1; margin: 0;">üîì Descifrar</button>
        </div>

        <div class="result-box">
            <h4>Resultado:</h4>
            <textarea id="cipher-result" rows="6" readonly placeholder="El resultado aparecer√° aqu√≠..."></textarea>
            <small style="display: block; margin-top: 8px; color: #666;">
                üí° <strong>Tip:</strong> Para AES, copia el texto cifrado, p√©galo en el campo de entrada y usa
                "Descifrar" con la misma contrase√±a.
            </small>
        </div>

        <div class="info-box" style="margin-top: 16px; background: #e3f2fd; border-left-color: #2196f3;">
            <h4>üìö Implementaci√≥n t√©cnica</h4>
            <p><strong>Cifrado C√©sar:</strong></p>
            <div class="code-example">
                <pre>
// Implementado con JavaScript 
function cesarEncrypt(text, shift) {
    return text.split('').map(char => {
        if (char.match(/[a-z]/i)) {
            const code = char.charCodeAt(0);
            const isUpperCase = code >= 65 && code <= 90;
            const base = isUpperCase ? 65 : 97;
            return String.fromCharCode(((code - base + shift) % 26) + base);
        }
        return char;
    }).join('');
}
                </pre>
            </div>

            <p style="margin-top: 16px;"><strong>Cifrado AES-GCM:</strong></p>
            <div class="code-example">
                <pre>
// Web Crypto API
const encoder = new TextEncoder();
const salt = crypto.getRandomValues(new Uint8Array(16));
const iv = crypto.getRandomValues(new Uint8Array(12));

// Derivar clave desde contrase√±a con PBKDF2
const keyMaterial = await crypto.subtle.importKey(
    'raw', encoder.encode(password), 'PBKDF2', false, ['deriveBits', 'deriveKey']
);

const key = await crypto.subtle.deriveKey(
    { name: 'PBKDF2', salt, iterations: 100000, hash: 'SHA-256' },
    keyMaterial, { name: 'AES-GCM', length: 256 }, false, ['encrypt']
);

// Cifrar
const encrypted = await crypto.subtle.encrypt(
    { name: 'AES-GCM', iv }, key, encoder.encode(text)
);
                </pre>
            </div>

            <p style="margin-top: 12px;"><strong>Librer√≠as utilizadas:</strong></p>
            <ul>
                <li><strong>Cifrado C√©sar:</strong> JavaScript puro (charCodeAt, String.fromCharCode)</li>
                <li><strong>AES-GCM:</strong> Web Crypto API nativa del navegador (crypto.subtle)</li>
                <li><strong>PBKDF2:</strong> Derivaci√≥n de clave incluida en Web Crypto API</li>

            </ul>
        </div>
    </div>

    <div class="info-box">
        <h4>Cifrado C√©sar (cifrado cl√°sico) [1,2]</h4>
        <p>Usado por Julio C√©sar hace m√°s de 2000 a√±os. Desplaza cada letra un n√∫mero fijo de posiciones en el alfabeto.
        </p>
        <ul>
            <li><strong>Ejemplo:</strong> Con desplazamiento 3: A‚ÜíD, B‚ÜíE, C‚ÜíF, HOLA‚ÜíKROD</li>
            <li><strong>Funcionamiento:</strong> Solo cifra letras (A-Z), mantiene may√∫sculas/min√∫sculas, ignora n√∫meros
                y s√≠mbolos</li>
            <li><strong>Seguridad:</strong> ‚ùå Muy d√©bil - solo 25 posibles claves (desplazamientos 1-25)</li>
            <li><strong>Vulnerabilidad:</strong> Se rompe en segundos con an√°lisis de frecuencia o fuerza bruta</li>
            <li><strong>Uso moderno:</strong> Solo educativo, nunca para seguridad real (ROT13 es C√©sar con shift=13)
            </li>
        </ul>
    </div>

    <div class="info-box" style="background: #e8f5e9; border-left-color: #4caf50;">
        <h4>AES-GCM (Advanced Encryption Standard - modo Galois/Counter) [1,2]</h4>
        <p>Est√°ndar moderno usado en WiFi (WPA3), HTTPS (TLS 1.3), VPNs, Signal, WhatsApp y m√°s. Adoptado por el
            gobierno de EE.UU. en 2001.</p>
        <ul>
            <li><strong>Implementaci√≥n:</strong> ‚úÖ <strong>Cifrado real</strong> usando Web Crypto API del navegador (no
                simulado)</li>
            <li><strong>Algoritmo:</strong> AES-256-GCM con PBKDF2 (100,000 iteraciones) para derivar clave desde
                contrase√±a</li>
            <li><strong>Seguridad:</strong> ‚úÖ Extremadamente seguro con contrase√±a adecuada (2^256 ‚âà 10^77
                combinaciones)</li>
            <li><strong>GCM:</strong> Proporciona autenticaci√≥n e integridad adem√°s de confidencialidad (detecta
                manipulaci√≥n)</li>
            <li><strong>Salt e IV aleatorios:</strong> Cada cifrado genera valores √∫nicos, mismo texto + contrase√±a =
                cifrados diferentes</li>
            <li><strong>PBKDF2:</strong> Derivaci√≥n lenta de clave (dificulta ataques de diccionario)</li>
            <li><strong>Uso:</strong> El texto cifrado incluye salt + IV + datos cifrados codificados en Base64</li>
        </ul>
        <p style="margin-top: 10px; padding: 10px; background: #fff9c4; border-radius: 5px;">
            <strong>‚ö†Ô∏è Importante:</strong> Para descifrar, usa <strong>exactamente la misma contrase√±a</strong> que
            usaste para cifrar.
            Una contrase√±a incorrecta generar√° error de autenticaci√≥n.
        </p>
    </div>

    <div class="info-box" style="background: #e3f2fd; border-left-color: #2196f3;">
        <h4>üß™ Ejercicios sugeridos</h4>
        <ol>
            <li><strong>C√©sar:</strong> Cifra "HOLA MUNDO" con desplazamiento 3, luego desc√≠fralo con el mismo n√∫mero
            </li>
            <li><strong>C√©sar ROT13:</strong> Cifra un mensaje con desplazamiento 13, nota que cifrarlo dos veces lo
                restaura</li>
            <li><strong>AES b√°sico:</strong> Cifra "Mensaje secreto" con contrase√±a "MiClave123", copia resultado,
                desc√≠fralo</li>
            <li><strong>AES seguridad:</strong> Cifra el mismo texto dos veces con igual contrase√±a, observa que los
                resultados son diferentes (salt/IV √∫nicos)</li>
            <li><strong>AES fallo:</strong> Intenta descifrar con contrase√±a incorrecta, verifica que detecta el error
            </li>
        </ol>
    </div>
</section>